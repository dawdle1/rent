<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Bike Rental</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
body { font-family: Arial, sans-serif; margin: 0; background:#f5f5f5; }
header { background:#111; color:#fff; padding:15px; text-align:center; }
.container { max-width:1200px; margin:auto; padding:15px; }
.grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(260px,1fr)); gap:15px; }
.card { background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,.1); }
.card img { width:100%; height:180px; object-fit:cover; }
.card-body { padding:10px; }
.price { font-weight:bold; }
.status.free { color:green; }
.status.booked { color:red; }
.slider { position:relative; }
.slider button {
  position:absolute; top:50%; transform:translateY(-50%);
  background:rgba(0,0,0,.5); color:#fff; border:none; font-size:18px;
  padding:5px 10px; cursor:pointer;
}
.slider .prev { left:5px; }
.slider .next { right:5px; }
</style>
</head>
<body>

<header>
  <h1>Bike Rental</h1>
</header>

<div class="container">
  <div id="grid" class="grid"></div>
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQkiyZdafVIMIamvuz4dP7PvJwfuzIYAw0k1_NjhQYbpFNCz7jfb0xn3blCawJrIfZuUgC4beUQd8vP/pub?gid=510031858&single=true&output=csv";
const IMAGE_PATH = "Images/";

function parseCSV(text) {
  const rows = [];
  let row = [], cell = "", inside = false;
  for (let c of text) {
    if (c === '"') inside = !inside;
    else if (c === ',' && !inside) { row.push(cell); cell = ""; }
    else if ((c === '\n' || c === '\r') && !inside) {
      if (cell || row.length) { row.push(cell); rows.push(row); }
      row = []; cell = "";
    } else cell += c;
  }
  if (cell || row.length) { row.push(cell); rows.push(row); }
  return rows;
}

fetch(CSV_URL)
  .then(r => r.text())
  .then(text => {
    const data = parseCSV(text);
    const headers = data[0];
    const rows = data.slice(1);

    const bikes = rows.map(r => {
      const obj = {};
      headers.forEach((h,i) => obj[h.trim()] = (r[i]||"").trim());
      return obj;
    });

    render(bikes);
  });

function render(bikes){
  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  bikes.forEach(b => {
    const images = b.image_urls
      ? b.image_urls.split("|").map(x => IMAGE_PATH + x.trim())
      : ["https://via.placeholder.com/400x300?text=No+Image"];

    let idx = 0;

    const card = document.createElement("div");
    card.className = "card";

    const slider = document.createElement("div");
    slider.className = "slider";

    const img = document.createElement("img");
    img.src = images[0];
    slider.appendChild(img);

    if(images.length > 1){
      const prev = document.createElement("button");
      prev.className = "prev";
      prev.textContent = "<";
      prev.onclick = ()=>{ idx = (idx-1+images.length)%images.length; img.src = images[idx]; };

      const next = document.createElement("button");
      next.className = "next";
      next.textContent = ">";
      next.onclick = ()=>{ idx = (idx+1)%images.length; img.src = images[idx]; };

      slider.appendChild(prev);
      slider.appendChild(next);
    }

    card.appendChild(slider);

    const body = document.createElement("div");
    body.className = "card-body";
    body.innerHTML = `
      <div><b>${b.brand} ${b.model}</b> ${b.year || ""}</div>
      <div class="price">Day: ${b.price_day_thb || "-"} THB</div>
      <div class="price">Month: ${b.price_month_thb || "-"} THB</div>
      <div class="status ${b.status}">Status: ${b.status}</div>
    `;
    card.appendChild(body);

    grid.appendChild(card);
  });
}
</script>

</body>
</html>
